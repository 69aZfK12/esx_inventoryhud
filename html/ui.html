<!DOCTYPE html>
<html>

<head>
  <meta name="author" content="Trsak; trsak1@seznam.cz; GameSites.cz">
  <title>ESX Inventory HUD</title>
  <link rel="stylesheet" id="themonic-fonts-css" href="css/contextMenu.min.css" type="text/css" media="all" />
  <link rel="stylesheet" id="themonic-fonts-css" href="css/ui.css" type="text/css" media="all" />
</head>

<body>
  <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
  <script type="text/javascript" src="js/contextMenu.min.js"></script>

  <div id="inventoryHud">
    <div id="inventoryElement">
    </div>
  </div>


  <script type="text/javascript">
    $("document").ready(function () {
      $("#inventoryHud").hide();

      $("body").on("keyup", function (key) {
        if (key.which == 113) {
          $.post("http://esx_inventoryhud/NUIFocusOff", JSON.stringify({}));
        }
      });

      window.addEventListener("message", function (event) {
        if (event.data.action == "display") {
          $("#inventoryHud").fadeIn();
        }
        else if (event.data.action == "hide") {
          $("#inventoryHud").fadeOut();
        }
        else if (event.data.action == "setItems") {
          inventorySetup(event.data.itemList);
        }
      });
    });

    function inventorySetup(items) {
      $("#inventoryElement").html("");
      $.each(items, function (index, item) {
        count = item.count;

        if (item.limit > 0) {
          count = count + " / " + item.limit;
        }

        $("#inventoryElement").append("<div style='background-image: url(\"img/items/burger.png\");' id='item-" + index + "' class='item'><div class='count'>" + count + "</div><div class='text'>" + item.label + "</div></div>")

        var data = [];

        if(item.usable) {
          data.push({text: "Použít"});
        }

        if (item.canRemove) {
          data.push({text: "Zahodit"});
        }

        console.log(JSON.stringify(data));

        if (data.length > 0) {
          $("#item-" + index).contextMenu([data], {
            offsetX: 1,
            offsetY: 1,
          });
        }
      });
    }
  </script>
</body>

</html>